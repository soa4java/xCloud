<!DOCTYPE html><html lang="en"><head>    <meta charset="UTF-8">    <title>用户管理</title>    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">    <link rel="stylesheet" href="node_modules/layui-src/dist/css/layui.css">    <script type="text/javascript" src="node_modules/jquery/dist/jquery.min.js"></script>    <script type="text/javascript" src="node_modules/layui-src/dist/layui.all.js"></script>    <script>        function updateUserStatus(user_id, user_status) {            $.ajax({                url: "user/updateUserStatus.do",                method: "post",                data: {                    "user_status": user_status,                    "user_id": user_id                },                success: function (res) {                    if (res == 1){                        layer.msg('修改成功！', {icon: 1});                    }                }, error: function () {                    layer.msg('请求服务器失败！', {icon: 2});                }            });            getNewUser(1, 10);        }        $(function () {            //第一次获取前10条            getNewUser(1, 10);            // alert( sessionStorage.getItem("user_id"));            layui.table.on("edit(filetable)", function (rs) {                $.ajax({                    url: "user/updateNewUserName.do",                    method: "get",                    data: {"obj": JSON.stringify(rs.data)},                    success: function (data) {                        if (data == 0)                            layer.msg("编辑" + rs.data.username + "失败");                        else                            layer.msg("编辑" + rs.data.username + "成功");                    },                    error: function () {                        layer.msg("请求服务器失败！");                    }                });            });        });        // 获取用户列表        function getNewUser(page, pagesize) {            layui.use("table", function () {                layui.table.render({                    elem: "#file_manager_table",                    url: "user/newUserManger.do",                    title: "新注册用户列表",                    where: {                        "user_status": sessionStorage.getItem("user_status"),//0未处理，1同意，-1拒绝                    },                    page: true,                    limit: pagesize,                    id: "id",//自己起名                    size: "md",                    toolbar: '#tbl_toolbar',                    limits: [10, 20, 50, 100],                    loading: true,                    even: true,                    cols: [[                        {field: "User_id", title: "ID", align: "center", type: "checkbox"},                        {field: "", title: "序号", type: "numbers"},                        {                            field: "user_id", title: "用户 ID", width: 100, align: "center",                        },                        {field: "username", title: "用户名", edit: "text", totalRow: true},                        {field: "email", title: "邮箱", edit: "text", totalRow: true},                        {                            field: "register_time", title: "注册时间", width: 250, align: "center",                            templet: function (row) {                                return new Date(row.register_time).toLocaleString();                            }                        },                        {                            field: "newUser_action", title: "操作", width: 200, align: "center",                            templet: function (row) {                                var deletefile = "<a id='status2' href='javascript:updateUserStatus(" + row.user_id + "," + "-1)' title='拒绝' class='layui-badge' >拒绝</a>";                                var downloadfile = "<a d='status1' href='javascript:updateUserStatus(" + row.user_id + "," + "1)' title='激活' class='layui-badge layui-bg-green'>激活</a>";                                return deletefile + " " + downloadfile;                            }                        }                    ]]                });                layui.table.on("toolbar(filetable)", function (rs) {                    var event = rs.event;                    if (event == "add") {                        layer.msg(event);                    }                    if (event == "delete") {                        var tableselectdate = layui.table.checkStatus("id").data;                        var arr = new Array();                        $.each(tableselectdate, function (index, row, rs) {                            arr[index] = row.file_id;                        });                        // alert(JSON.stringify(arr));                        if (arr.length == 0) {                            layer.msg("请选择一行数据");                        } else {                            layer.confirm('是否要真的删除选中数据？', {                                btn: ['确定', '取消'], //按钮                                btnAlign: 'c'  //按钮居中显示                            }, function () {                                // layer.msg(JSON.stringify(arr), {icon: 1});                                $.ajax({                                    url: "file/deleteFileById.do",                                    data: {"file_id": JSON.stringify(arr)},                                    method: "post",                                    success: function (data) {                                        if (data > 0)                                            layer.msg("成功删除" + data + "个文件", {icon: 1});                                        else                                            layer.msg('文件删除失败', {icon: 2});                                        /*数据删除成功后刷新表格*/                                        layui.table.reload("id", {                                            where: {                                                "file_upload_user": sessionStorage.getItem("user_id")                                            }                                        });                                    },                                    error: function () {                                        layer.msg('请求服务器失败！', {icon: 1});                                    }                                });                            });                        }                    }                });            });        }    </script></head><body><script type="text/html" id="tbl_toolbar">    <div class="layui-block">        <span class="layui-icon layui-icon-form" style="color: red"></span>        以下是新注册用户，请您处理！        <button class="layui-btn layui-btn-danger" lay-event="delete" style="margin-left: 50px">            <i class="layui-icon layui-icon-ok-circle"></i> 批量激活        </button>    </div></script><table id="file_manager_table" lay-filter="filetable"></table></body></html>