var InterValObj; //timer变量，控制时间var count = 60; //间隔函数，1秒执行var curCount;//当前剩余秒数//向邮箱发送验证码$('#send-email-code').click(function () {    //校验邮箱    var email = $("#email").val();    if (!email.match(/^[a-z0-9]+([._]*[a-z0-9]+)*@[a-z0-9]+([_.][a-z0-9]+)+$/gi)) {        layer.msg("邮箱格式不正确！请重新输入!", {            time: 2000        });        return false;    }    // 设置button效果，开始计时    curCount = count;    document.getElementById("send-email-code").setAttribute("disabled", "true");//设置按钮为禁用状态    document.getElementById("send-email-code").value = curCount + "秒后重获";//更改按钮文字    InterValObj = window.setInterval(SetRemainTime, 1000); // 启动计时器timer处理函数，1秒执行一次    //请求验证码    $.ajax({        type: "post",        url: "email/sendCode.do",        data: {            "userEmail": email        },        beforeSend: function () {            $("#login_loading").html("<span class='layui-icon layui-icon-loading'></span>");        },        complete: function () {            $("#login_loading").empty();        },        success: function (res) {            // alert(res);            if (res == 1) {//验证码发送成功                $('#emailTip').html("<span style='color: #339933'>√ 验证码已发到您的邮箱,请查收</span>");            } else {                $("#emailTip").html("<span style='color: #339933'>× 验证码发送失败，请重新发送</span>");            }        },    });});//timer处理函数function SetRemainTime() {    if (curCount == 0) {//超时重新获取验证码        window.clearInterval(InterValObj);// 停止计时器        document.getElementById("send-email-code").removeAttribute("disabled");//移除禁用状态改为可用        document.getElementById("send-email-code").value = "重获验证码";    } else {        curCount--;        document.getElementById("send-email-code").value = curCount + "秒后重获";    }}$('#submit-email-code').click(function () {    var email = $("#email").val();    if (!email.match(/^[a-z0-9]+([._]*[a-z0-9]+)*@[a-z0-9]+([_.][a-z0-9]+)+$/gi)) {        layer.msg("邮箱格式不正确！请重新输入!", {            time: 2000        });        return false;    }    var emailCode = $("#emailCode").val();    if (emailCode==null||emailCode=="") {        layer.msg("验证码不能为空!", {            time: 2000        });        return false;    }    $.ajax({        url: "email/loginByEmail.do",        method: "post",        data: {            "userEmail": $("#email").val(),            "emailCode": $("#emailCode").val()        },        beforeSend: function () {            $("#login_loading").html("<span class='layui-icon layui-icon-loading'></span>");        },        complete: function () {            // alert('远程调用成功，状态文本值：'+textStatus);            $("#login_loading").empty();        },        success:function(res){            var jsonObj = JSON.parse(res);            // alert("resloginCode"+jsonObj.loginCode);            if (jsonObj.loginCode == 1) {                if (jsonObj.status == 0) {                    layer.msg("用户未激活，请联系管理员!", {                        time: 2000                    });                } else {                    sessionStorage.setItem("uname", jsonObj.username);                    sessionStorage.setItem("user_id", jsonObj.user_id);                    sessionStorage.setItem("headPath", jsonObj.headPath);                    if (jsonObj.user_type == "admin") {                        window.location.href = "admin_index.html";                    } else {                        window.location.href = "user_index.html";                    }                }            } else {                layer.msg("登录失败，请重试!", {                    time: 2000                });            }        },        error: function () {            layer.alert("连接服务器未成功!", {icon: 6});        }    });});